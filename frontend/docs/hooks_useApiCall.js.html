<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: hooks/useApiCall.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: hooks/useApiCall.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// src/hooks/useApiCall.js
import { useState, useEffect, useCallback } from 'react';
import apiClient from '../api/apiClient';

/**
 * Resultado devuelto por el hook useApiCall.
 *
 * @typedef {Object} ApiCallResult
 * @property {Array&lt;any>} data        - Array de resultados (normalizado a array).
 * @property {boolean}     loading     - Indica si la petición está en curso.
 * @property {Error|null}  error       - Error ocurrido o null si no hay error.
 * @property {function():void} refetch - Función para volver a ejecutar la llamada manualmente.
 */

/**
 * Hook genérico para realizar llamadas a la API y normalizar la respuesta siempre como un array.
 *
 * @param {string} endpoint
 *   Ruta de la API a la que se hará la solicitud (por ejemplo '/productos').
 * @param {'get'|'post'|'put'|'patch'|'delete'} [method='get']
 *   Método HTTP a utilizar.
 * @param {Object|null} [body=null]
 *   Cuerpo de la solicitud para métodos POST, PUT o PATCH.
 * @param {Array&lt;any>} [dependencies=[]]
 *   Dependencias que, al cambiar, volverán a disparar la llamada.
 * @returns {ApiCallResult}
 *   Objeto con propiedades { data, loading, error, refetch }.
 */
const useApiCall = (endpoint, method = 'get', body = null, dependencies = []) => {
  const [data, setData] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  /**
   * Ejecuta la petición a la API usando axios, actualiza los estados
   * y normaliza la respuesta a un array.
   *
   * @async
   * @private
   * @returns {Promise&lt;void>}
   */
  const callApi = useCallback(async () => {
    setLoading(true);
    setError(null);

    const lowerMethod = method.toLowerCase();
    let request;
    if (lowerMethod === 'get' || lowerMethod === 'delete') {
      request = apiClient[lowerMethod](endpoint);
    } else if (['post', 'put', 'patch'].includes(lowerMethod)) {
      request = apiClient[lowerMethod](endpoint, body);
    } else {
      return Promise.reject(new Error(`Método ${method} no soportado`));
    }

    try {
      const response = await request;
      let result = response.data;
      if (!Array.isArray(result)) {
        result = [result];
      }
      setData(result);
    } catch (err) {
      setError(err);
    } finally {
      setLoading(false);
    }
  }, [endpoint, method, body, ...dependencies]);

  useEffect(() => {
    callApi();
  }, [callApi]);

  return { data, loading, error, refetch: callApi };
};

export default useApiCall;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Externals</h3><ul><li><a href="external-AxiosInstance.html">AxiosInstance</a></li></ul><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#AppContext">AppContext</a></li><li><a href="global.html#CarritoPage">CarritoPage</a></li><li><a href="global.html#CrearCuenta">CrearCuenta</a></li><li><a href="global.html#CrearProducto">CrearProducto</a></li><li><a href="global.html#EditarProducto">EditarProducto</a></li><li><a href="global.html#EliminarProductos">EliminarProductos</a></li><li><a href="global.html#Header">Header</a></li><li><a href="global.html#Home">Home</a></li><li><a href="global.html#Item">Item</a></li><li><a href="global.html#ItemCarrito">ItemCarrito</a></li><li><a href="global.html#ItemConfirmado">ItemConfirmado</a></li><li><a href="global.html#ItemModificar">ItemModificar</a></li><li><a href="global.html#ItemPage">ItemPage</a></li><li><a href="global.html#Login">Login</a></li><li><a href="global.html#MenuPage">MenuPage</a></li><li><a href="global.html#ModificarProducto">ModificarProducto</a></li><li><a href="global.html#NotFoundPage">NotFoundPage</a></li><li><a href="global.html#PagarPage">PagarPage</a></li><li><a href="global.html#SeccionTitulo">SeccionTitulo</a></li><li><a href="global.html#SeguimientoPage">SeguimientoPage</a></li><li><a href="global.html#UsuarioPage">UsuarioPage</a></li><li><a href="global.html#apiClient">apiClient</a></li><li><a href="global.html#useApiCall">useApiCall</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat May 10 2025 18:06:11 GMT+0200 (hora de verano de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
